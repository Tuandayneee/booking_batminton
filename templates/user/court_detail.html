{% extends 'base/base.html' %}
{% load static %}
{% load humanize %}

{% block title %}Đặt sân {{ court.name }} - Badminton Pro{% endblock %}

{% block content %}
<div class="container py-5">
    <div class="row g-5">
        
        <div class="col-lg-7 fade-in-up">
            <div class="position-relative mb-5">
                <img src="https://images.unsplash.com/photo-1626224583764-847890e05851?q=80&w=1000" class="court-hero-img" alt="{{ court.name }}">
                <div class="position-absolute top-0 end-0 m-4">
                    <span class="badge bg-white text-dark shadow-sm px-3 py-2 rounded-pill fw-bold">
                        <i class="fa-solid fa-star text-warning me-1"></i> 5.0 (12 đánh giá)
                    </span>
                </div>
            </div>

            <div class="court-info-card">
                <div class="d-flex justify-content-between align-items-start mb-3">
                    <div>
                        <h2 class="fw-bold text-dark mb-2">{{ court.name|default:"Sân Cầu Giấy Arena - Sân 1" }}</h2>
                        <p class="text-secondary mb-0">
                            <i class="fa-solid fa-location-dot me-2 text-danger"></i> 
                            123 Xuân Thủy, Cầu Giấy, Hà Nội
                        </p>
                    </div>
                    <div class="text-end">
                        <h3 class="fw-bold text-primary mb-0">50k<small class="fs-6 text-muted fw-normal">/h</small></h3>
                    </div>
                </div>

                <hr class="border-secondary opacity-10 my-4">

                <div class="mb-4">
                    <h5 class="fw-bold text-dark mb-3">Tiện ích sân</h5>
                    <div class="d-flex flex-wrap gap-2">
                        <span class="badge-amenity"><i class="fa-solid fa-layer-group text-success"></i> Thảm Yonex</span>
                        <span class="badge-amenity"><i class="fa-solid fa-wifi text-info"></i> Wifi miễn phí</span>
                        <span class="badge-amenity"><i class="fa-solid fa-square-parking text-warning"></i> Bãi đỗ xe</span>
                        <span class="badge-amenity"><i class="fa-solid fa-snowflake text-primary"></i> Điều hòa</span>
                    </div>
                </div>

                <div>
                    <h5 class="fw-bold text-dark mb-2">Mô tả</h5>
                    <p class="text-secondary lh-lg mb-0">
                        Sân mới nâng cấp hệ thống ánh sáng LED chống chói tiêu chuẩn thi đấu 2025. 
                        Không gian thoáng đãng, trần cao 12m, đảm bảo không bị lóa mắt khi phông cầu. 
                        Khu vực nghỉ ngơi rộng rãi, có quầy nước giải khát.
                    </p>
                </div>
            </div>
        </div>

        <div class="col-lg-5 fade-in-up" style="animation-delay: 0.1s;">
            <div class="booking-card">
                <div class="card-header bg-white border-bottom py-4 px-4">
                    <h4 class="fw-bold text-dark mb-0">Đặt lịch giữ chỗ</h4>
                    <p class="text-muted small mb-0 mt-1">Chọn ngày và giờ bạn muốn chơi</p>
                </div>
                
                <div class="card-body p-4">
                    <form method="POST">
                        {% csrf_token %}
                        
                        <div class="mb-4">
                            <label class="form-label fw-bold small text-uppercase">Ngày chơi</label>
                            <div class="input-group-unified">
                                <span class="input-group-text"><i class="fa-regular fa-calendar"></i></span>
                                <input type="date" class="form-control fw-bold text-dark" value="{% now 'Y-m-d' %}">
                            </div>
                        </div>

                        <div class="mb-4">
                            <label class="form-label fw-bold small text-uppercase mb-3 d-flex justify-content-between">
                                <span>Khung giờ trống</span>
                                <span class="text-muted fw-normal text-transform-none"><i class="fa-solid fa-circle text-success me-1" style="font-size: 6px; vertical-align: middle;"></i>Còn chỗ</span>
                            </label>
                            
                            <div class="row g-2">
                                <div class="col-4">
                                    <input type="checkbox" class="btn-check slot-input" id="t1" name="slots" value="17:00">
                                    <label class="btn w-100 py-2 slot-label rounded-3" for="t1">17:00</label>
                                </div>
                                <div class="col-4">
                                    <input type="checkbox" class="btn-check slot-input" id="t2" name="slots" value="18:00">
                                    <label class="btn w-100 py-2 slot-label rounded-3" for="t2">18:00</label>
                                </div>
                                <div class="col-4">
                                    <button class="btn w-100 py-2 slot-disabled rounded-3 border-0" disabled>19:00</button>
                                </div>
                                <div class="col-4">
                                    <input type="checkbox" class="btn-check slot-input" id="t3" name="slots" value="20:00">
                                    <label class="btn w-100 py-2 slot-label rounded-3" for="t3">20:00</label>
                                </div>
                            </div>
                        </div>

                        <div class="bg-light p-3 rounded-3 mb-4 d-flex justify-content-between align-items-center border border-light">
                            <span class="text-secondary fw-medium">Tổng tạm tính</span>
                            <span class="fs-4 fw-bold text-dark" id="totalPrice">0đ</span>
                        </div>

                        <button type="submit" class="btn btn-submit w-100 rounded-3 shadow-sm">
                            Thanh toán ngay <i class="fa-solid fa-arrow-right ms-2"></i>
                        </button>
                        
                        <div class="text-center mt-3 d-flex align-items-center justify-content-center gap-2 text-muted small">
                            <i class="fa-solid fa-shield-halved"></i> Thanh toán an toàn 100%
                        </div>
                    </form>
                </div>
            </div>
        </div>

    </div>
</div>
{% endblock %}

{% block extra_js %}
<script>
    // Script đơn giản để tính tổng tiền demo
    document.addEventListener("DOMContentLoaded", function() {
        const checkboxes = document.querySelectorAll('.slot-input');
        const totalEl = document.getElementById('totalPrice');
        const pricePerHour = 50000;

        checkboxes.forEach(cb => {
            cb.addEventListener('change', function() {
                const count = document.querySelectorAll('.slot-input:checked').length;
                totalEl.textContent = (count * pricePerHour).toLocaleString('vi-VN') + 'đ';
            });
        });
    });
</script>
{% endblock %}